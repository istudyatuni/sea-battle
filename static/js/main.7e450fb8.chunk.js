(this["webpackJsonpsea-battle"]=this["webpackJsonpsea-battle"]||[]).push([[0],[,,,,function(e,t,n){},,function(e,t,n){},function(e,t,n){},,function(e,t,n){e.exports=n(20)},,,,,function(e,t,n){},,function(e,t,n){var a={"./en.json":17,"./ru.json":18};function r(e){var t=o(e);return n(t)}function o(e){if(!n.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}r.keys=function(){return Object.keys(a)},r.resolve=o,e.exports=r,r.id=16},function(e){e.exports=JSON.parse('{"disabled":"Disabled","enabled":"Enabled","fix_ships":"Fix ships","fix_ships_explain":"You can fix ships if place them wrong","friend_id":"Friend ID","go_battle":"Go battle","good_game":"Good game!","one_minute_timeout":"We waited for your opponent for a minute...","player":"Player","please_wait":"Please wait","server_unavailable":"Server unavailable","your_id":"Your ID"}')},function(e){e.exports=JSON.parse('{"disabled":"\u0412\u044b\u043a\u043b\u044e\u0447\u0435\u043d\u043e","enabled":"\u0412\u043a\u043b\u044e\u0447\u0435\u043d\u043e","fix_ships":"\u041f\u043e\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u043a\u043e\u0440\u0430\u0431\u043b\u0438","fix_ships_explain":"\u0412\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u0438\u0441\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0440\u0430\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0443 \u043a\u043e\u0440\u0430\u0431\u043b\u0435\u0439, \u0435\u0441\u043b\u0438 \u043e\u0448\u0438\u0431\u043b\u0438\u0441\u044c","friend_id":"ID \u0434\u0440\u0443\u0433\u0430","go_battle":"\u0412 \u0431\u043e\u0439","good_game":"\u0423\u0434\u0430\u0447\u043d\u043e\u0439 \u0438\u0433\u0440\u044b!","one_minute_timeout":"\u0416\u0434\u0430\u043b\u0438 \u0432\u0430\u0448\u0435\u0433\u043e \u0441\u043e\u043f\u0435\u0440\u043d\u0438\u043a\u0430 \u043c\u0438\u043d\u0443\u0442\u0443, \u043d\u0435 \u0434\u043e\u0436\u0434\u0430\u043b\u0438\u0441\u044c...","player":"\u0418\u0433\u0440\u043e\u043a","please_wait":"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u043f\u043e\u0434\u043e\u0436\u0434\u0438\u0442\u0435","server_unavailable":"\u0421\u0435\u0440\u0432\u0435\u0440 \u043d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u0435\u043d","your_id":"\u0412\u0430\u0448 ID"}')},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var a,r=n(0),o=n.n(r),s=n(8),i=n.n(s),c=(n(14),n(2)),l=n.n(c),u=n(3),p=n(1),m=(n(6),function(e){return a[e]}),f=function(){var e=Object(u.a)(l.a.mark((function e(t,n,a,r,o){var s,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/ships",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({opponent:a,ships:t})});case 2:if(!(s=e.sent).ok){e.next=11;break}return e.next=6,s.json();case 6:i=e.sent,n(i.id),"0"!==i.opponentID?(b(!0,"success",m("good_game")),setTimeout((function(){y()}),30)):(b(!0,"info",m("please_wait")),v(i.id,r,o)),e.next=13;break;case 11:b(!0,"error",m("server_unavailable")),console.error("Failed, response status: ",s.status);case 13:case"end":return e.stop()}}),e)})));return function(t,n,a,r,o){return e.apply(this,arguments)}}(),d=function(){var e=Object(u.a)(l.a.mark((function e(t,n,a,r){var o,s,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o="/shot?id="+t+"&x="+n+"&y="+a,e.next=3,fetch(o,{method:"GET",headers:{"Content-Type":"application/json"}});case 3:if(202!==(s=e.sent).status){e.next=9;break}b(!0,"info",m("please_wait")),console.error("Failed, response status: ",s.status),e.next=20;break;case 9:if(!s.ok){e.next=18;break}return e.next=12,s.json();case 12:return i=e.sent,e.next=15,r(i);case 15:b(!1),e.next=20;break;case 18:b(!0,"error",m("server_unavailable")),console.error("Failed, response status: ",s.status);case 20:case"end":return e.stop()}}),e)})));return function(t,n,a,r){return e.apply(this,arguments)}}(),v=function(e,t,n){var a=new WebSocket("ws://localhost:4000/ws/"+e);a.onopen=function(){a.send(JSON.stringify({id:e}))},a.onmessage=function(e){var r=e.data,o=JSON.parse(r);"0"!==o.opponentID?(t(o.opponentID),b(!0,"success",m("good_game")),y()):(b(!0,"warn",m("one_minute_timeout")),a.close(1e3,"Timeout by server"),setTimeout((function(){n(0),b(!1)}),1e4))},a.onerror=function(e){b(!0,"error","Error: "+e),alert("WebSocket error: "+e),console.error("Failed: ",e)}},b=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=document.getElementById("popup");null!==a&&(a.classList.remove("success","error","info","warn"),!0===e?(a.classList.add("show"),a.classList.add(t)):a.classList.remove("show"),a.innerHTML=n+"<span>\xd7</span>")},h=function(){for(var e=[],t=0;t<10;t++){for(var n=[],a=0;a<10;a++)n.push(0);e.push(n)}return e},g=function(e){if(1===e)return{display:"none"}},E=function(){var e=Object(u.a)(l.a.mark((function e(t,n,a,r){var o,s,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=function(){return(i=Object(u.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=t.type;case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)},s=function(e){return i.apply(this,arguments)},o="none",e.next=5,d(t,n,a,s);case 5:"miss"===o?r(n,a,1):"hit"===o&&r(n,a,2);case 6:case"end":return e.stop()}}),e)})));return function(t,n,a,r){return e.apply(this,arguments)}}(),y=function(){var e=document.getElementById("yID");null!==e&&(e.style.display="none")},O=function(e){e.setMode;var t=e.gameMode,n=e.goBattle,a=e.setClear,s=e.isClear,i=e.setOpponentID,c=e.ID,l=e.copyOpID,u=Object(r.useState)(""),f=Object(p.a)(u,2),d=f[0],v=f[1];return o.a.createElement("div",{className:"Buttons"},o.a.createElement("form",{onSubmit:function(e){n(),e.preventDefault()},style:g(t)},o.a.createElement("label",null,m("friend_id"),": ",o.a.createElement("input",{type:"number",value:d,placeholder:"0",onChange:function(e){var t=e.target.value;t>0&&(v(t),i(t))}})),o.a.createElement("input",{type:"submit",value:m("go_battle")})),o.a.createElement("button",{onClick:function(){return a(!s)},style:g(t)},m("fix_ships")),o.a.createElement("i",{style:g(t)},m(!0===s?"enabled":"disabled")),o.a.createElement("p",{style:g(t)},m("fix_ships_explain")),o.a.createElement("span",{style:g((t+1)%2),id:"yID",onClick:function(){l()}},m("your_id"),": ",c))},j=(n(7),function(e){var t=e.count,n=e.name;return o.a.createElement("div",{className:"CounterTab"},o.a.createElement("p",null,t),o.a.createElement("p",null,n))}),w=function(e){var t=e.player1,n=e.player2;return o.a.createElement("div",{className:"Scoreboard"},o.a.createElement(j,{count:t,name:m("player")+" 1"}),o.a.createElement(j,{count:n,name:m("player")+" 2"}))},x=(n(4),function(e){var t;return t="assets/"+(t=!0===e.isKill?"Hit":"Miss")+"Small.png",o.a.createElement("div",{className:"Indicator"},o.a.createElement("img",{src:t,alt:""}))}),k=function(e){var t=e.i,n=e.name,a=e.count,s=e.kill,i=e.changeKill,c="assets/"+n+"Shape.png",l=Object(r.useState)(d()),u=Object(p.a)(l,2),m=u[0],f=u[1];function d(){for(var e=[],t=0;t<s;t++)e.push(o.a.createElement(x,{isKill:!0}));for(var n=s;n<a;n++)e.push(o.a.createElement(x,{isKill:!1}));return e}return Object(r.useEffect)((function(){f(d())}),[s]),o.a.createElement("div",{className:"Ship"},o.a.createElement("img",{src:c,alt:n}),o.a.createElement("p",null,a),m,o.a.createElement("button",{onClick:function(){i(t,1)}},"+"),o.a.createElement("p",null,s))},_=["Aircraft","Battleship","Cruiser","Submarine","Carrier"],S=function(){var e=Object(r.useState)([0,0,0,0,0]),t=Object(p.a)(e,2),n=t[0],a=t[1];function s(e,t){var r=n;r[e]=(r[e]+1)%(e+2),a(r)}return o.a.createElement("div",{className:"Shipsboard"},function(){for(var e=[],t=0;t<5;t++)e.push(o.a.createElement(k,{key:[t,n[t]].toString(),i:t,name:_[t],count:t+1,kill:n[t],changeKill:s}));return e}())},C=function(e){if(1===e)return{cursor:"url('assets/aim50.png') 25 25, auto"}},N=o.a.memo((function(e){var t=e.i,n=e.isClear,a=e.element,s=e.gameMode,i=e.setCell,c=e.shot;function l(e){var r;return 0===s?!1===e?(r=function(e,t){return!1===e&&!1===t?"Ship":"Empty"}(e,n),i(t)):!0===n?(r="Empty",1===a&&(r="Ship")):r="Empty":1===s&&(!1===e?0===a?(c(t),r="Empty"):1===a?r="Miss":2===a&&(r="Hit"):r=0===a?"Empty":1===a?"Miss":"Hit"),r="assets/"+r+".png",o.a.createElement("img",{src:r,alt:"",width:"100%",height:"100%"})}Object(r.useEffect)((function(){d(l(!0))}),[a]);var u=Object(r.useState)(l(!0)),m=Object(p.a)(u,2),f=m[0],d=m[1];return o.a.createElement("div",{className:"Cell",onClick:function(){return d(l(!1))},style:C(s)},f)})),I=o.a.memo((function(e){var t=e.i,n=e.isClear,a=e.gameMode,s=e.row,i=e.shot,c=Object(r.useState)(s);function p(e){Object(u.a)(l.a.mark((function n(){return l.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,i(t,e);case 2:case"end":return n.stop()}}),n)})))()}function m(e){s[e]=!1===n?1:0}s=c[0];var f=function(){for(var e=[],t=0;t<10;t++)e.push(o.a.createElement(N,{i:t,isClear:n,gameMode:a,setCell:m,shot:p,element:s[t]}));return e}();return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"CellRow"},f))})),D=(n(19),function(e){var t=e.isClear,n=e.gameMode,a=e.field,r=e.shot;var s=function(){for(var e=[],s=0;s<10;s++)e.push(o.a.createElement(I,{i:s,isClear:t,gameMode:n,row:a[s],shot:r}));return e}();return o.a.createElement("div",{className:"Battlefield"},s)}),M=function(){!function(e){e=e||navigator.language||"en",a=n(16)("./"+e+".json");var t=document.getElementById("html");null!==t&&t.setAttribute("lang",e)}();var e=Object(r.useState)(0),t=Object(p.a)(e,2),s=t[0],i=(t[1],Object(r.useState)(0)),c=Object(p.a)(i,2),m=c[0],d=(c[1],Object(r.useState)(0)),v=Object(p.a)(d,2),g=v[0],y=v[1],j=Object(r.useState)(h()),x=Object(p.a)(j,2),k=x[0],_=x[1],C=Object(r.useState)(!1),N=Object(p.a)(C,2),I=N[0],M=N[1],B=Object(r.useState)("0"),T=Object(p.a)(B,2),F=T[0],L=T[1],J=Object(r.useState)("0"),K=Object(p.a)(J,2),W=K[0],H=K[1],A=Object(r.useState)("light"),G=Object(p.a)(A,2),P=G[0],U=G[1];function Y(e,t,n){var a=k;a[e][t]=n,_(a)}Object(r.useEffect)((function(){var e=document.getElementById("html");null!==e&&("light"===P?e.classList.remove("dark-mode"):"dark"===P&&e.classList.add("dark-mode"))}),[P]);var R=function(){var e=Object(u.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f(k,H,F,L,y);case 2:_(h()),y(1),M(!1);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),$=Object(r.useState)(0),q=Object(p.a)($,2),z=q[0],Q=q[1],V=function(){var e=Object(u.a)(l.a.mark((function e(t,n){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E(F,t,n,Y);case 2:Q(z+1);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return o.a.createElement("div",{className:"App"},o.a.createElement("div",{className:"theme-toggle",onClick:function(){"light"===P?U("dark"):"dark"===P&&U("light")}},"\ud83c\udf13"),o.a.createElement("div",{className:"inline-board"},o.a.createElement(w,{player1:s,player2:m}),o.a.createElement(S,null),o.a.createElement(O,{gameMode:g,setMode:y,goBattle:R,isClear:I,setClear:M,setOpponentID:L,ID:W,copyOpID:function(){navigator.clipboard.writeText(W)}})),o.a.createElement("div",{className:"inline-field"},o.a.createElement(D,{key:g.toString(),isClear:I,gameMode:g,field:k,shot:V})),o.a.createElement("div",{className:"popup"},o.a.createElement("div",{className:"popup-box",id:"popup",onClick:function(){return b(!1)}})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(M,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}],[[9,1,2]]]);
//# sourceMappingURL=main.7e450fb8.chunk.js.map